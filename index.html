<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Quiz IBGE Animado</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  .question { margin-bottom: 15px; }
  button {
    margin: 5px;
    padding: 10px 15px;
    border: none;
    border-radius: 6px;
    background-color: #3498db;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: transform 0.2s, background-color 0.3s;
  }
  button:hover {
    background-color: #2980b9;
    transform: scale(1.05);
  }
  button:active {
    background-color: #1abc9c;
    transform: scale(0.95);
  }
  .correct {
    background-color: #2ecc71; /* Verde */
  }
  .incorrect {
    background-color: #e74c3c; /* Vermelho */
  }
  button.disabled {
    pointer-events: none;
    opacity: 0.7;
  }
</style>
</head>
<body>
<h1>Simulado IBGE – Nível Médio</h1>
<div id="quiz"></div>

<script>
let questions = [];
let current = 0;
let score = 0;

function showQuestion(){
  const q = questions[current];
  const quizDiv = document.getElementById("quiz");
  let html = `<div class="question"><p>${current+1}. ${q.q}</p>`;
  q.options.forEach((opt,i)=>{
    // Usamos atributos data-* para armazenar o índice da opção
    html += `<button data-choice="${i}">${String.fromCharCode(65+i)}) ${opt}</button>`;
  });
  html += `</div>`;
  quizDiv.innerHTML = html;

  // Adiciona os event listeners aos novos botões
  quizDiv.querySelectorAll('button').forEach(button => {
    button.addEventListener('click', (event) => {
      checkAnswer(parseInt(event.target.dataset.choice));
    });
  });
}

function checkAnswer(choice){
  const q = questions[current];
  const buttons = document.querySelectorAll('#quiz button');

  // Desabilita todos os botões para evitar cliques múltiplos
  buttons.forEach(button => button.classList.add('disabled'));

  if(choice === questions[current].answer){ score++; }

  // Adiciona classes para feedback visual
  buttons[q.answer].classList.add('correct');
  if (choice !== q.answer) {
    buttons[choice].classList.add('incorrect');
  }

  // Avança para a próxima pergunta ou mostra o resultado final após um intervalo
  setTimeout(() => {
    current++;
    if(current < questions.length){
      showQuestion();
    } else {
      showResults();
    }
  }, 1500); // Espera 1.5 segundos antes de continuar
}

function showResults() {
  const quizDiv = document.getElementById("quiz");
  quizDiv.innerHTML =
    `<h2>Fim do simulado!</h2>
     <p>Pontuação: ${score}/${questions.length}</p>
     <p>Média final: ${(score/questions.length*10).toFixed(1)}</p>
     <button onclick="restartQuiz()">Reiniciar Quiz</button>`;
}

function restartQuiz() {
  current = 0;
  score = 0;
  showQuestion();
}

// Função principal que inicia o quiz
async function startQuiz() {
  try {
    const response = await fetch('questions.json'); // Carrega o arquivo JSON
    questions = await response.json(); // Converte a resposta em um objeto JavaScript
    showQuestion(); // Mostra a primeira pergunta
  } catch (error) {
    document.getElementById("quiz").innerHTML = "<p>Erro ao carregar as perguntas. Tente novamente mais tarde.</p>";
    console.error("Falha ao carregar o quiz:", error);
  }
}

startQuiz(); // Inicia o processo
</script>
</body>
</html>
